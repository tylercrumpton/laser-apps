<!DOCTYPE html>
<html>
  <head>
    <style>
      svg {
        max-width: 100%;
        height: auto;
        margin: 10px;
      }
  #circleForm {
    background-color: #f8f8f8;
    border-radius: 10px;
    padding: 20px;
    font-family: sans-serif;
  }

  label {
    font-size: 18px;
    margin-bottom: 5px;
    display: block;
  }

  input[type="text"],
  input[type="number"],
  input[type="button"] {
    height: 40px;
    width: 100%;
    border-radius: 5px;
    border: 1px solid #ccc;
    font-size: 16px;
    margin-bottom: 15px;
    padding: 10px;
    box-sizing: border-box;
    transition: border-color 0.3s ease-in-out;
  }

  input[type="text"]:hover,
  input[type="number"]:hover,
  input[type="button"]:hover {
    border-color: #333;
  }

  input[type="text"]:focus,
  input[type="number"]:focus,
  input[type="button"]:focus {
    border-color: #555;
    outline: none;
  }

  input[type="button"] {
    background: linear-gradient(to bottom, #4f94c3 0%, #3c79a1 100%);
    border: none;
    color: #fff;
    cursor: pointer;
    font-size: 16px;
    font-weight: bold;
    margin-top: 15px;
    text-align: center;
    text-transform: uppercase;
    padding: 10px 20px;
    transition: opacity 0.3s ease-in-out;
  }

  input[type="button"]:hover {
    opacity: 0.8;
  }
</style>
    </style>
  </head>
  <body>
    <form id="circleForm">
      <label for="names">Names (comma-separated):</label>
      <input
        type="text"
        id="names"
        name="names"
        value="John Doe, Jane Smith, Alice Johnson, Bob Brown, Eva Adams"
      /><br />
      <label for="words">Words (comma-separated):</label>
      <input
        type="text"
        id="words"
        name="words"
        value="Courageous, Bombastic, Daring, Energetic, Fearless"
      /><br />
      <label for="circleSize">Circle size (mm):</label>
      <input
        type="number"
        id="circleSize"
        name="circleSize"
        min="10"
        max="300"
        step="1"
        value="25.4"
      /><br />
      <label for="holeSize">Hole size:</label>
      <input
        type="number"
        id="holeSize"
        name="holeSize"
        min=".1"
        max="300"
        step="1"
        value="1"
      /><br />
      <label for="offset">Engrave circle offset:</label>
      <input
        type="number"
        id="offset"
        name="offset"
        min="0"
        max="100"
        step="1"
        value="1"
      /><br />
      <label for="padding">Text padding:</label>
      <input
        type="number"
        id="padding"
        name="padding"
        min="0"
        max="100"
        step="1"
        value="5"
      /><br />
      <label for="hSpacing">Horizontal spacing between circles:</label>
      <input
        type="number"
        id="hSpacing"
        name="hSpacing"
        min="0"
        max="100"
        step="1"
        value="1"
      /><br />
      <label for="vSpacing">Vertical spacing between circles:</label>
      <input
        type="number"
        id="vSpacing"
        name="vSpacing"
        min="-100"
        max="100"
        step="1"
        value="-2.5"
      /><br />
      <label for="tokensPerRow">Tokens per Row:</label>
      <input
        type="number"
        id="tokensPerRow"
        name="tokensPerRow"
        min="1"
        max="100"
        step="1"
        value="3"
      /><br />

      <input type="button" value="Generate Circles" onclick="init()" />
      <input type="button" value="Download SVG" onclick="downloadSVG()" />
    </form>
    <svg
      id="mainSVG"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
    ></svg>
    <script>
      const createCircleWithName = (name, word, id, size, offset, holeSize) => {
        return `
        <g id="${id}">
          <circle cx="${size / 2}" cy="${size / 2}" r="${
          size / 2
        }" stroke="red" stroke-width="0.5" fill="none"/>
          <circle cx="${size / 2}" cy="${size / 2}" r="${
          size / 2 - offset
        }" stroke="blue" stroke-width="0.5" fill="none"/>
        <circle cx="${size / 2}" cy="${
          offset + holeSize * 2
        }" r="${holeSize}" stroke="red" stroke-width="0.5" fill="none"/>
        <text x="${size / 2}" y="${
          size / 2
        }" dominant-baseline="middle" text-anchor="middle" font-size="50" font-family="Montserrat, Helvetica, Arial" font-weight="600" class="word" fill="yellow">${word}</text>
          <text x="${size / 2}" y="${
          size / 2
        }" dominant-baseline="middle" text-anchor="middle" font-size="50" font-family="Montserrat, Helvetica, Arial" font-weight="600" class="name" fill="green">${name}</text>
        </g>
      `;
      };

      const resizeText = (id, size, offset, padding, elementClass) => {
        const text = document.querySelector(`#${id} text.${elementClass}`);
        const bbox = text.getBBox();
        const maxWidth = size * offset - padding;
        const scaleFactor = maxWidth / bbox.width;

        text.setAttribute("font-size", scaleFactor * 50);
      };

      const generateCircles = (
        names,
        words,
        circleSize,
        offset,
        padding,
        hSpacing,
        vSpacing,
        holeSize,
        tokensPerRow
      ) => {
        const mainSVG = document.getElementById("mainSVG");
        const totalSVGWidth = (circleSize + hSpacing) * names.length - hSpacing;
        const numRows = Math.ceil(names.length / tokensPerRow);
        const totalSVGHeight = (circleSize + hSpacing) * numRows - hSpacing;
        mainSVG.setAttribute("width", `${totalSVGWidth}mm`);
        mainSVG.setAttribute("height", `${totalSVGHeight}mm`);
        mainSVG.setAttribute(
          "viewBox",
          `0 0 ${totalSVGWidth} ${totalSVGHeight}`
        );
        mainSVG.innerHTML = "";

        names.forEach((name, index) => {
          const id = `circle-${index}`;
          const circleWithName = createCircleWithName(
            name,
            words[index],
            id,
            circleSize,
            offset,
            holeSize
          );
          mainSVG.insertAdjacentHTML("beforeend", circleWithName.trim());
          resizeText(id, circleSize, offset, padding, "word");
          resizeText(id, circleSize, offset, padding, "name");
          const group = document.getElementById(id);
          const xOffset =
            (index % tokensPerRow) * (circleSize + hSpacing) +
            ((circleSize + hSpacing) * (Math.floor(index / tokensPerRow) % 2)) /
              2;
          const yOffset =
            Math.floor(index / tokensPerRow) * (circleSize + vSpacing);
          group.setAttribute("transform", `translate(${xOffset}, ${yOffset})`);
        });
      };

      function init() {
        const namesStr = document.getElementById("names").value;
        const wordsStr = document.getElementById("words").value;
        const circleSize = parseInt(
          document.getElementById("circleSize").value
        );
        const offset = parseInt(document.getElementById("offset").value);
        const hSpacing = parseInt(document.getElementById("hSpacing").value);
        const vSpacing = parseInt(document.getElementById("vSpacing").value);
        const padding = parseInt(document.getElementById("padding").value);
        const names = namesStr.split(",").map((name) => name.trim());
        const words = wordsStr.split(",").map((word) => word.trim());
        const holeSize = parseInt(document.getElementById("holeSize").value);
        const tokensPerRow = parseInt(
          document.getElementById("tokensPerRow").value
        );
        generateCircles(
          names,
          words,
          circleSize,
          offset,
          padding,
          hSpacing,
          vSpacing,
          holeSize,
          tokensPerRow
        );
      }

      const downloadSVG = () => {
        const svg = document.getElementById("mainSVG");
        const svgData = new XMLSerializer().serializeToString(svg);
        const blob = new Blob([svgData], { type: "image/svg+xml" });
        const url = URL.createObjectURL(blob);
        const downloadLink = document.createElement("a");
        downloadLink.href = url;
        downloadLink.download = "circles.svg";
        document.body.appendChild(downloadLink);
        downloadLink.click();
        document.body.removeChild(downloadLink);
        URL.revokeObjectURL(url);
      };

      init();
    </script>
  </body>
</html>
